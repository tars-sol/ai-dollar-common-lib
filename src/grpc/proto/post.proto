syntax = "proto3";

package post;
import "google/protobuf/empty.proto";
service PostService {
  rpc Create (CreatePostRequest) returns (PostResponse);
  rpc Update (UpdatePostRequest) returns (PostResponse);
  rpc GenerateUploadUrl (GenerateUploadUrlRequest) returns (GenerateUploadUrlResponse);
  rpc GetFeed (GetFeedRequest) returns (GetFeedResponse);
  rpc VoteOnPoll (VoteOnPollRequest) returns (PostResponse);
  rpc GetUserPosts(GetUserPostsRequest) returns (GetFeedResponse);
  rpc PostReaction(PostReactionRequest) returns (PostResponse);
  rpc CreateComment(CreateCommentRequest) returns (CommentResponse);
  rpc GetComments(GetCommentsRequest) returns (GetCommentsResponse);
  rpc DeletePost(DeletePostRequest) returns (SuccessResponse);
  rpc AddToPortfolio(AddToPortfolioRequest) returns (SuccessResponse);
  rpc RemoveFromPortfolio(RemoveFromPortfolioRequest) returns (SuccessResponse);
  rpc GetPortfolio(GetPortfolioRequest) returns (GetFeedResponse);
  rpc Health(google.protobuf.Empty) returns (HealthResponse);
}

message CreatePostRequest {
  string profileId = 1;
  string caption = 2;
  string accessType = 3;
  string postType = 8;
  optional string mimeType = 4;
  optional string giphyUrl=13;
  optional string mediaType = 9;
  optional string s3Key = 5;
  optional string fileType = 6;
  optional string originalFileName = 7;
  optional string pollEndTime=10;
  repeated string options = 11;
}
message DeletePostRequest{
  string id = 1;
  string profileId = 2;
}
message SuccessResponse{
  bool success = 1;
}
message UpdatePostRequest {
  string id = 1;
  string profileId = 2;
  optional string caption = 3;
  optional string accessType = 4; 
}

message GenerateUploadUrlRequest {
  string profileId = 1;
  string fileName = 2;
  string contentType = 3;
}

message GenerateUploadUrlResponse {
  string uploadUrl = 1;
  string key = 2;
}

message GetFeedRequest {
  string profileId = 1;
  uint32 page = 2;
  uint32 perPage = 3; 
}

message GetFeedResponse {
  repeated PostResponse posts = 1;
}
message CreateCommentRequest{
  string profileId = 1;
  string text = 2;
  string postId = 3;
}
message CommentResponse{
  string profileId = 1;
  string text = 2;
  string postId = 3;
  string createdAt=4;
  string updatedAt=5;
  string id = 6;
}
message GetCommentsRequest{
  string postId=1;
}
message GetPortfolioRequest{
  string profileId=1;
}
message GetCommentsResponse{
 repeated CommentResponse comments=1;
}
message PostMediaResponse{
  string id = 6;
  optional string mimeType = 1;
  string mediaType = 2;
  optional string s3Key = 3;
  optional string originalFileName = 4;
  optional string signedUrl = 5;
  optional string giphyUrl=7;

}

message PostFileResponse{
  string id = 6;
  string mimeType = 1;
  string s3Key = 3;
  string originalFileName = 4;
  string signedUrl = 5;
  string fileType = 7;
  string sizeInBytes = 8;

}
message VoteOnPollRequest{
  string profileId = 1;
  string postId = 2;
  string optionId = 3;
}
message HealthResponse{
  bool isHealthy = 1;
}
message PostPollResponse{
  string id = 1;
  string pollEndTime = 2;
  repeated string votedProfilePics = 3;
  repeated PostPollOptionResponse postPollOptions = 4;
}
message PostPollOptionResponse{
  string id = 1;
  string text = 2;
  string voteCount = 3;
  string indexNumber=4;
  bool userVoted = 5;
}
message PostReactionRequest{
  string profileId= 1;
  string postId= 2;
  bool reaction = 3;
  string reactionType=4;

}

message Creator {
  string name = 1;
  string image = 2;
  bool isVerified = 3;
}
message AddToPortfolioRequest{
  string profileId= 1;
  repeated string postIds= 2;
}

message RemoveFromPortfolioRequest{
  string profileId= 1;
  repeated string postIds= 2;
}

message PostResponse {
  string id = 1;
  string profileId = 2;
  string caption = 3;
  string accessType = 4;
  string postType = 5;
  optional PostMediaResponse postMedia = 6;
  optional PostPollResponse postPoll=7;
  optional PostFileResponse postFile=8;
  string createdAt = 9;
  string updatedAt = 10;
  string commentCount = 11;
  string likeCount = 12;
  string dislikeCount = 13;
  optional Creator creator = 14;
  optional bool viewerLiked = 15;
  optional bool viewerDisliked = 16;
}
message GetUserPostsRequest{
  string profileId = 1;
}